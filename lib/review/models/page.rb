require 'httparty'
require 'cgi'

class Page

  BLACKLIST = ['path.com', 'instagram.com', 'facebook.com', 'paper.li', 'pinterest.com', 'guestlistapp.com', 'ow.ly', 'foursquare.com', 'yelp.com', 'stumbleupon.com', 'digg.com', 'reddit.com', 'slashdot.org', 'delicious.com', 'fark.com', 'technorati.com', 'citeulike.org', 'connotea.org', 'diigo.com', 'folkd.com', 'hotklix.com', 'metafilter.com', 'mister-wong.com', 'newsvine.com', 'squidoo.com', 'wikio.com', 'blinklist.com', 'a1-webmarks.com', 'bizsugar.com', 'designfloat.com', 'dropjack.com', 'farkinda.com', 'givealink.org', 'jumptags.com', 'kwoff.com', 'lifehack.org', 'newsmeback.com', 'oneview.com', 'pusha.se', 'rollyo.com', 'social-bookmarking.net', 'startaid.com', 'wirefan.com', 'baang.ir', 'buddymarks.com', 'chime.in', 'designbump.com', 'designmoo.com', 'dotnetkicks.com', 'faves.com', 'fwisp.com', 'hotbmark.com', 'linkagogo.com', 'mototagz.com', 'netvouz.com', 'scoopit.co.nz', 'shetoldme.com', 'svejo.net', 'tagza.com', 'openfaves.com', 'youmob.com', 'xmarks.com', 'seo4bookmarks.com', 'chungkhoan84.com', 'clipclip.org', 'hecangetit.com', 'edutagger.com', 'marketprice.com.vn', 'panodigg.com', 'chuza.gl', 'weheartgossip.com', 'clipmarks.com', 'bookmarkrally.com', 'swik.net', 'wists.com', 'babblestorm.co.uk', 'bookmarktracker.com', 'bookmarks2u.com', 'dealigg.com', 'dnhour.com', 'e-secondmortgages.com', 'faqpal.com', 'feedmarker.com', 'ewebmarks.com', 'maglev08.com', 'malaysiastory.com', 'oyax.com', 'pixelgroovy.com', 'popscreen.com', 'sphinn.jp', 'wedigg.co.uk', 'zimmerforsenate.com', 'b2blocal.net', 'blogengage.com', 'blogmarks.net', 'blogospherenews.com', 'bookmarkcart.com', 'jeqq.com', 'koreantopnews.com', 'linkarena.com', 'linkr.hu', 'myhq.com', 'poweredbypligg.info', 'qaafe.com', 'bookmarkinghost.com', 'shabagossip.com', 'sitejot.com', 'sponter.com', 'wapher.moffed.com', 'wickedmarks.com', 'fabulositybookmarks.com', 'spiffysocialbookmarks.com', 'superbmarking.com', 'bagamare.ro', 'bloggerden.com', 'bmaccess.net', 'bookmark4you.com', 'bookmarkdofollow.com', 'book-marky.de', 'bookmarkwiki.com', 'business-planet.net', 'craftjuice.com', 'dezinews.com', 'diggplus.net', 'ezyspot.com', 'earnersclub.net', 'easymash.com', 'healthbubble.com', 'humsurfer.com', 'joomlanews.ro', 'seosubmitbookmark.com', 'lepiocheur.com', 'limca.info', 'llinks.org', 'moldfacts.org', 'moomdigg.com', 'mumor.com.ar', 'mylinkvault.com', 'bookmarkgroups.com', 'newskicks.com', 'notizieflash.com', 'pinoymug.com', 'pr4links.com', 'rambhai.com', 'socialbookmarkingzone.com', 'spotifylists.com', 'votetags.com', 'alltopics.com', 'tedigo.net', 'seobookmarkingsites.com', 'upnews.it', 'abcphp.com', 'afunpark.com', 'alltopics.com', 'socialbookmarkiseasy.info', 'blogsvine.com', 'bookmarksync.com', 'communityradar.com', 'confesen.com', 'socialbookmarkzone.info', 'design.fr', 'dugdig.net', 'geimhost.com', 'flash3sb.net', 'livewebmarks.com', 'eviplist.com', 'onlinearticlesubmit.com', 'findbetterlinks.com', 'jetdonkey.com', 'openwebmarks.com', 'i89.us', 'oomega.com', 'nuzcom.com', 'bookmarkingbiz.com', 'jjdigg.com', 'kojaxx.com', 'kwzz.com', 'peoplebookmarks.com', 'linksubmitz.com', 'listyoururl.com', 'malayaliclassifieds.com', 'newsgarbage.com', 'greateststory.info', 'ortakweb.com', 'posicionatuweb.es', 'postolia.com', 'review.zazi.com', 'a2zbookmarks.com', 'siamhothit.com', 'solinkable.com', 'spartansportspage.com', 'cadillactight.net', 'swebbo.com', 'prbookmarks.com', 'therealpassport.com', 'topinews.com', 'uan.me', 'urselections.com', 'villanews.net', 'vtransit.com', 'bookmarkdiary.com', 'webmaster911.com', 'westhamnews.net', 'whotome.com', 'celebhungama.com', 'bookmarkcart.info', 'zabox.net', 'againlinks.com', 'agroots.com', 'arteporcuba.com', 'autocino.de', 'socialwebmarks.com', 'blessingg.com', 'blinky.co.nz', 'boer.co.il', 'freewebmarks.com', 'cerrolimon.com', 'click2web.net', 'topsocialbookmarkseo.com', 'disdroid.co.uk', 'dizzed.com', 'falconrynetwork.com', 'fuzenews.com', 'hotbookmarking.com', 'headusnext.com', 'hotplugin.com', 'hubstory.com', 'ipopu.com', 'jaadigg.com', 'jetmarks.com', 'seowebmarks.com', 'kiefit.com', 'votetags.info', 'linkroll.com', 'liputankhusus.com', 'marketguild.com', 'mostfashionable.com', 'myfavlinks.com', 'bookmarkrally.info', 'osusports.info', 'justartic.com', 'pop-music.ne', 'onlinewebmarks.com', 'savingsdaily.com', 'seedz.org', 'shiur.com', 'sitesays.com', 'jumbobookmarks.com', 'bookmarkinghost.info', 'socialarticle.com', 'socialbookmarklink.com', 'socialmedia1.com', 'storeboard.com', 'swagtagger.com', 'bookmarkdiary.info', 'the-news.biz', 'thinkbigusa.com', 'tweet-this.com', 'followmenow.info', 'webmasterclip.com', 'webwhompers.net', 'welcome-business.com', 'westpoplarredangus.com', 'whatlifeismeanttobe.com', 'socbookmarking.com', 'younews.in', 'youtubefilter.com', 'bookmarkdeal.com', 'addblogurl.com', 'articwoof.com', 'aviationcentral.ne', 'socialbookmarknow.info', 'bgbox.info', 'billstrickland.info', 'blogcharts.net', 'blurpalicious.com', 'newsciti.com', 'bookmarkall.com', 'bookmarkarticles.com', 'bookmarkciti.com', 'bookmarkinsider.com', 'bsocialbookmarking.info', 'bookmarkzine.com', 'bookmox.com', 'budgetlegaladvice.com', 'bukmarkit.com', 'a2zbookmarking.com', 'whtsup.net', 'cenq.com', 'clubzad.com', 'socialbookmarkingtime.info', 'crisscrosslink.info', 'cubeglobe.com', 'd474rpr.com', 'dealshouter.com', 'socialbookmarkingnow.info', 'digg.soizaa.com', 'directoriotop.com', 'donedigg.com', 'etamil.net', 'freesbmblog.info', 'juiceuplinks.info', 'finnol.com', 'flamewars.net', 'a2zbookmarking.info', 'garden-fairy.net', 'getindude.com', 'guinness416.com', 'readandrefer.com', 'jindalisgood.com', 'iidigg.com', 'indianupdatestoday.com', 'aynrandia.com', 'listitsocial.com', 'lawrkhawm.com', 'mettablog.com', 'mleip.com', 'modle.de', 'mybookmarks.ro', 'socialbookmarksite.info', 'mytitbits.com', 'namama.net', 'nulify.com', 'onlinesocialbookmarking.com', 'bookmarkingbiz.info', 'plibb.com', 'pqrnews.com', 'product-life.com', 'qiel.com', 'raidx.co.uk', 'bookmarkmaps.com', 'rulist.net', 'rusfoot.ru', 's43.de', 's4seo.info', 'share.ae', 'socbookmarking.info', 'sitemarks.in', 'site-publishing.com', 'smarkster.com', 'bookmarkmaps.info', 'social-bookmarks-site.com', 'socialdofollow.com', 'socialmediaarticle.com', 'socialn.net', 'activebookmarks.com', 'startupbug.com', 'subbmitt.com', 'submit2this.com', 'supertechnews.com', 'talkativetown.com', 'teshuvatrumpet.org', 'thegnuru.com', 'thuhm.com', 'way2bookmarks.com', 'websocialhub.com', 'welovedigg.com', 'worldoftags.com', 'wpthemez.com', 'wtfiwwp.com', 'yoogr.com', 'yoorl.com', 'ysome.com', 'sharneefenwick.com', 'alyssabliss.net', 'bishtarin.ir', 'blog.mn', 'bookmarkdig.com', 'futurismnews.com', 'facerob.com', 'bookmark-site.com', 'releaseurls.com', 'boomarking.com', 'burlador.net', 'choosenprice.com', 'choowawa.com', 'clickuplink.com', 'dailynewshype.com', 'dealdigs.com', 'digghappy.com', 'dzone.com', 'ebookmarkingsite.com', 'way2pr.com', 'favorise.com', 'fizzit.ca', 'flashbuzz.info', 'forsaving.com', 'free-samples-canada.com', 'frum.ru', 'gabquest.com', 'globalmixx.com', 'globusport.com', 'gotagged.com', 'hit.web.tr', 'humansthink.com', 'in2.pl', 'indimine.com', 'irejection.com', 'itafoo.com', 'joe.com.ar', 'justaddsocial.com', 'just-bloom.com', 'kledy.us', 'linkets.com', 'linking-directory.com', 'linkmarking.com', 'linktutorials.com', 'microrival.com', 'mistakerr.com', 'musicrati.com', 'myebuzz.net', 'mynewsmarker.com', 'napoligg.com', 'n-ews.de', 'mypeekkid.com', 'nsfwork.com', 'do-follow.com', 'pligg.in', 'socialbookmarkings.com', 'prisonbreakfic.com', 'projectscommunity.com', 'propellerd.com', 'qazee.com', 'ravintolatempo.com', 'rygtetsiger.dk', 'saveourpolice.com', 'sociopost.com', 'linkingjunction.com', 'share-news.net', 'techaker.com', 'techinreview.com', 'topsocial.info', 'topstumbles.com', 'tottlers.com', 'trulili.com', 'tweetr.in', 'upcoming.pl', 'vertical-politics.com', 'startbookmarks.com', 'waxandfeathers.net', 'webample.com', 'weedo.co.uk', 'yoconmarkit.co.uk', 'zetadigg.com', '123socialbookmarking.com', 'a2zsocialbookmarking.com', 'aaur.info', 'ads.mutu.org', 'atozbookmarks.com', 'aus-web-directory.com', 'autohometransport.com', 'b3ck.net', 'backlinkdofollow.com', 'backlinkfree.info', 'backlinkstate.com', 'bcnifm.com', 'bestpricesstock.com', 'beststumbles.com', 'biqboq.com', 'blessedit.com', 'blv-socialbookmarking.com', 'bookmark88.de', 'bookmarkalley.com', 'bookmarkclick.com', 'bookmarkgo.info', 'bookmarkhub.co.cc', 'bookmarkindonesia.com', 'bookmarkking.info', 'bookmarkshut.info', 'bookmarkslinks.com', 'bookmarkspad.com', 'bookmarkwheel.info', 'brightsapphire.com', 'buk-mark.com', 'buzz.ready2beat.com', 'cheapstockprice.com', 'chennailatest.com', 'chuv.com.ua', 'classicbookmarks.com', 'clipmarker.net', 'cloudytags.info', 'delicious123.com', 'digg-digg.com', 'directoryvote.com', 'diving-in-bunaken.com', 'dizzedlink.info', 'dofollowarticle.com', 'dropyourlink.com', 'figg.ehila.net', 'forexbookmarks.com', 'freebiesup.com', 'freesubmiturl.net', 'gobigg.com', 'guitarlinks.1stclasslinks.info', 'hagader.com', 'hillera.com', 'hztnt.com', 'imleme.com', 'impactartsgroup.com', 'inbookmark.com', 'indiansoicalbookmarking.com', 'jenifersamaha.com', 'jetkitty.com', 'kapely.net', 'k-kitten.net', 'krazd.com', 'latestbookmarks.com', 'lawgregate.com', 'leftmyheart.org', 'liiink.com', 'linksmarker.info', 'linkvote.com', 'markurls.com', 'mediaoptimize.info', 'medicalschoolresources.com', 'minglesocial.com', 'mobiletechfan.com', 'mobiletechfan.com', 'mondodifficile.com', 'mumbailatest.com', 'mvpsummit2008.com', 'mybukmark.com', 'ness-leisure.com', 'newsinweb.net', 'newsmarking.com', 'o7fr.com', 'onestopbookmarks.com', 'ov3.net', 'oyle.org', 'pixelpace.com', 'planscellular.com', 'playerforever.net', 'pligg.ncnm.edu', 'ratebookmarks.com', 'revud.info', 'sanctifly.com', 'savingbristol.com', 'scholarlinks.net', 'scoopd.info', 'share.digitss.com', 'sharoviki.ru', 'sitesmash.com', 'slurke.com', 'smslucu.web.id', 'socialbookmark.info', 'socialbookmarkingads.com', 'social-bookmarking-site.com', 'social-bookmarkz.info', 'sparklinkx.com', 'sprilo.com', 'sticktothis.com', 'stirnews.com', 'studentmedia.eu', 'submit.vizhole.com', 'submitanewstory.com', 'suffil.com', 'tamilnadulatest.com', 'telesmatic.com', 'topwsites.com', 'tunden.com', 'tungaw.com', 'universeharrypotter.com', 'vaginarino.org', 'vazak.com', 'veryhotlinks.com', 'w3bookmarks.com', 'wagill.com', 'weblinkmarker.com', 'windowly.com', 'winevoting.com', 'xpblogger.com', 'xyupload.com', 'xzbaodeng.com', 'yehiapress.org', 'yousaidnotoprom.com', 'adfreer.com', 'allcheap.us', 'aport.cc', 'backlinkvault.com', 'bibsonomy.org', 'bookmarkbay.com', 'oomega.info', 'buscoguia.net', 'commitx.com', 'dakotalife.net', 'digg.siamcrazy.com', 'diggasia.com', 'diggindy.com', 'diggtravel.com', 'diggup.co.uk', 'dosth.com', 'easyaddweb.com', 'farsijokes.com', 'fashionablylatent.com', 'favrbrands.com', 'fcc.com', 'frontstr8.com', 'gyach.com', 'haohaoreport.com', 'hostingindonesia.web.id', 'indexsocial.info', 'invadingbookmarks.com', 'investingtopix.com', 'investseeker.com', 'jkbookmarks.com', 'jxfishing.net', 'keplaza.com', 'likeley.com', 'luckdee.com', 'losmedieros.com', 'masterlinking.com', 'msbookmarks.com', 'mypip.com', 'myseobookmarks.com', 'news74.ru', 'newsbadge.com', 'newsinventory.com', 'newspad.de', 'newsreeltoday.com', 'nodds.com', 'nyheter24.no', 'onlinebookmark.info', 'tipd.com', 'ophee.com', 'paginas.cc', 'pakpetals.com', 'perfectezines.com', 'recentlydelicious.com', 'redhotchilipeppers.info', 'savetheurl.com', 'searchipnews.com', 'seobukmark.info', 'shlanxiao.com', 'shoppingdigg.net', 'shoppingsubmit.net', 'shortstory.in', 'sitehints.com', 'smutcircus.com', 'socialadda.com', 'socialbm.info', 'social-book-marking.com', 'social-bookmarking.org', 'socialchampion.net', 'socialmediafouls.com', 'societyweb.info', 'southkorea-link.co.cc', 'spikeim.com', 'sporticts.com', 'storymint.com', 'topic4u.com', 'topsitevalue.com', 'trythegreenway.com', 'ufcinfuzion.com', 'voip4vip.net', 'vote.my', 'waywardbuzz.com', 'weblogicamedia.com', 'websocialbookmarking.com', 'yez.com.br', 'zdravei.net', '161woool.net', '1977.ws', '1our.com', '5starbookmarks.info', 'a1socialbookmarking.com', 'add.blogruv.com', 'addlikes.com', 'addstory.info', 'agenda.dsevilla.es', 'agoodjoke.com', 'amaze24.com', 'applewishes.ic.cz', 'articleprince.com', 'bestcarmove.com', 'bestpush.com', 'bookmark.seochitchat.com', 'bookmark4seo.com', 'bookmarkedbyus.info', 'bookmarkgalaxy.com', 'bookmarkgimp.com', 'bookmarkin.info', 'bookmarking-site.com', 'bookmarkingworld.com', 'bookmarkitnow.com', 'bookmarkix.info', 'bookmarklogs.info', 'bookmarkmiracle.com', 'bookmarkparadise.com', 'bookmarkplus.info', 'bookmarkriver.info', 'bookmarks.zmilez.com', 'bookmarksland.com', 'bookmarksplash.com', 'bookmarkszone.com', 'bookmarktoday.info', 'bookmarkvista.com', 'bookmarkway.com', 'brutalregime.com', 'bulksmsanywhere.com', 'buzzbookmarks.info', 'buzzednews.info', 'bytesocial.info', 'celebits.com', 'chillbookmarks.com', 'choicesocial.info', 'citytube.pl', 'clickfor.net', 'connectlinks.info', 'contentsocial.info', 'cruxbookmarks.com', 'dallasnn.com', 'dealsrock.com', 'dhani.info', 'digg.kz', 'digg.meemarket.com', 'digg.topgirlshop.com', 'diggit.dodma.com', 'diggit.in', 'dosocialbookmark.com', 'dotworldgroup.com', 'edensavr.org', 'eggig.com', 'escape-bbs.info', 'esocialbookmarks.com', 'favbookmarks.info', 'financial-hub.net', 'football777.com', 'forex24hs.com', 'forums.smutcircus.com', 'fotonews.site88.net', 'foxmarkers.info', 'freehotlinksdirectory.com', 'freeprrelease.net', 'freshdigg.com', 'friskposts.info', 'gaddiposh.com', 'gamblingdealz.com', 'gathernews.com', 'givealink.info', 'gosocialsubmit.com', 'hackysackdirectory.com', 'highschoolheadlines.com', 'hobbypornsite.hustej.net', 'hotbmarks.com', 'hubtags.info', 'idigit.net', 'im.seohocasi.com', 'imle.in', 'indexbookmarks.info', 'indexhood.com', 'indiamold.com', 'indonews.net', 'informami.altervista.org', 'insurance-ny.com', 'interiorinsider.com', 'iphoneapps.it', 'iphonemarketplace.com', 'jombuzz.com', 'kannikar.com', 'kategolink.com', 'keepyup.net', 'krazybling.com', 'lawdigg.com', 'leafprobably.com', 'leansocial.com', 'leetelo.com', 'lehey.com', 'letslinkme.com', 'linkbuzzer.co.uk', 'linkorati.info', 'linkpopo.com', 'links2share.com', 'linkschain.info', 'linksmaximizer.info', 'linkupsearch.com', 'listmarker.info', 'listpostings.info', 'listweb.info', 'littleguybigbucks.com', 'livewiresite.com', 'markednews.info', 'marketingland.com', 'markurl.info', 'mattersocial.com', 'meanstraffic.com', 'megaroll.info', 'merolinks.com', 'meshsocial.info', 'metrotagz.com', 'mirage3d.free.fr', 'missing-person-search.com', 'modocreativo.com', 'mom-reviewed.com', 'monsterbookmarks.info', 'm-topic.com', 'mycrappystatus.com', 'mynaturalhealthcare.com', 'myplace.comze.com', 'myseobookmarks.info', 'nashvillecountryproductions.com', 'needurl.net', 'neosocial.info', 'networkingnewstoday.com', 'newmexicolinkzone.com', 'news.adultbros.com', 'news.windsurfing.pro', 'novaolf.com', 'offshoreacres.com', 'onlybookmarks.info', 'openbm.info', 'openbookmarks.info', 'overratedmovies.com', 'p8t.net', 'pagehype.com', 'pbnews24.com', 'peppertwist.com', 'philbuzz.com', 'phpdug.info', 'pixelbookmarks.com', 'placesubmit.info', 'pligg.lemoncayennepepperdiet.com', 'pligg.nu', 'pligg.yagrysha.com', 'plugposts.info', 'pokernews2.com', 'popcontent.info', 'portal2health.com', 'postbuster.fr', 'poststory.freenice.org', 'powerlinkings.info', 'pricespecs.com', 'primebookmarks.com', 'prodpran.com', 'queuepons.com', 'rahrahgear.com', 'readwritewiki.com', 'relatesocial.com', 'rememit.com', 'reservesocial.info', 'restaurantreviewsblog.info', 'review-soft.ru', 'revisioncontrol.net', 'roadaholics.com', 'rumors.netsay.net', 'saveupfavorites.com', 'scooped.info', 'seek4news.com', 'seekbookmarks.info', 'seoswamy.com', 'sharehorse.com', 'sharethis.co.cc', 'shinymarker.com', 'sitevote.info', 'smartbuzz.in', 'socialbookmark69.com', 'social-bookmarks.thai-web.net', 'socialbuzzs.info', 'socialbyte.info', 'socialfurl.info', 'socialnetplus.info', 'socialtagger.com', 'socialwebplus.info', 'socialworldbuzz.info', 'southernsaturdays.com', 'spicybookmark.info', 'stockinfoway.com', 'storyboard.schoolsindelhi.com', 'stupidestsites.com', 'submit.funkruti.com', 'submitevent.com', 'submitnews.info', 'submitsocialbookmark.com', 'suggestbookmark.info', 'supereasyleads.com', 'swfc.info', 'syncbookmark.info', 'tachiyomionline.com', 'taggingkit.com', 'tagji.com', 'tagonsocial.info', 'tagsocial.info', 'takemetothemovies.net', 'tfpv.com', 'thesocialsubmit.info', 'thoribuzz.info', 'tiklattik.com', 'tlm.awardspace.com', 'toblogs.com.ar', 'topeven.com', 'traffic2social.com', 'trendymarks.info', 'twist.bestsail.org', 'ultimatelinking.info', 'universalbookmarks.com', 'urlscentral.com', 'villagemetro.com', 'votedmostpopular.com', 'webinarnotebook.com', 'weblinkr.com', 'websitebookmarks.com', 'wesnare.com', 'wikitags.info', 'wildlifewire.org', 'worthystuff.info', 'xbookmarking.com', 'x-oe.com', 'yourfootynews.com', 'zalozky.okamzite.eu', 'zebylinks.info', 'spurl.net', 'dofollow-bookmark.info', 'publishednewsstory.info', 'submitanewlink.info', 'sharenewsonline.info', 'articlesubmissionz.info', 'addanewurl.info', 'socialbookmarksubmissions.info', 'offsitelinks.info', 'submitastory.info', 'freeinternetmarketings.info', 'pressrelease-submission.info', 'linkmanagerz.info', 'freeclassifiedsindia.info', 'directorysubmissionz.info', 'writeanewpost.info', 'publishedscoops.info', 'upcomingnewssite.info', 'publishedupcomingnews.info', 'onlineadvertisingfree.info', 'socialbookmarkingservices.info', 'rajusoma.com', 'linkmanagerz.com', 'listdofollowsocialbookmarkingsites.com', 'listsocialbookmarking.com', 'listsocialbookmarkingsites.com', 'mostpopularsocialsites.com', 'offsitelinks.com', 'onlinebookmarksz.com', 'onlinebookmarklist.com', 'onlinebookmarkingsz.com', 'onlinebookmarkingsites.com', 'onlinesocialbookmarkz.com', 'onlinesocialbookmarkingsz.com', 'onlinesocialbookmarksz.com', 'onlinesoicalsites.com', 'pligghostings.com', 'pliggsocialbookmarkingsites.com', 'popularsocialsites.com', 'professionallinkbuildings.com', 'qalitybacklinksz.com', 'seodofollows.com', 'seodofollowblog.com', 'seosocialbookmarkings.com', 'seosocialmedias.com', 'sharesocialbookmarking.com', 'sitelinkbuildingsz.com', 'socialbookmarki.com', 'socialbookmarktools.com', 'socialbookmarkwebsitez.com', 'socialbookmarkwebsitesz.com', 'socialbookmarkersz.com', 'social-bookmarkingsz.com', 'socialbookmarkingadvantages.com', 'socialbookmarkingbuttonszs.com', 'socialbookmarkingdelicious.com', 'socialbookmarkingdofollowzs.com', 'howsocialbookmarking.com', 'socialbookmarkingiconsz.com', 'socialbookmarkingindia.com', 'socialbookmarkinglink.com', 'socialbookmarkinglinkbuilding.com', 'socialbookmarkinglistz.com', 'socialbookmarkingmarketings.com', 'socialbookmarkingnetworks.com', 'socialbookmarkingprogram.com', 'socialbookmarkingscript.com', 'socialbookmarkingservicez.com', 'socialbookmarkingservicesz.com', 'socialbookmarkingsitez.com', 'socialbookmarkingsharings.com', 'socialbookmarkingsitesi.com', 'socialbookmarkingsitesdofollow.com', 'socialbookmarksz.com', 'socialdofollows.com', 'socialmarkersz.com', 'socialmarketingsz.com', 'socialmediaadvertisings.com', 'socialmediaagencyz.com', 'socialmediablogsz.com', 'socialmediabusinessi.com', 'socialmediacompaniesz.com', 'socialmediaconsultantz.com', 'socialmediaconsultantsz.com', 'socialmediaconsultings.com', 'socialmediadesignsz.com', 'socialmediaexpertzs.com', 'socialmediaexpertsz.com', 'socialmediaforbusinessz.com', 'indiansoicalbookmarking.com', 'submitanewstory.com', 'scienceandjobs.com', 'somemorelinks.com', 'freebookmarkingsite.com', 'socialbookmarkinghere.com', 'free-socialbookmarking.com', 'freedofollowlink.com', 'addanewlink.com', 'sharenewslinks.com', 'submitanewlink.com', 'socialbookmarkingads.com', '2morelinks.com', 'qiinga.com', 'aaigg.com', 'lintasberita.com', 'bookvote.net', 'joseluispretto.com', 'corank.com', 'yoomark.com', 'cloudytags.com', 'superuse.org', 'bloggingcanadians.ca', 'mysitevote.com', 'sturvs.com', 'tweako.com', 'blogbookmark.com', 'craftig.com', 'enexpress.net', 'iaddyou.com', 'jetdonkey.com', 'linkatopia.com', 'oeone.net', 'seotagg.com', 'tamilers.com', 'yemle.com', 'wazit.it', 'bestofindya.com', 'buzzingtopics.com', 'dekut.com', 'goodwebsubmit.com', 'khmer2.com', 'safarisamsclub.com', 'onlinebookmarkingsite.com', 'slixo.com', 'themesbuzz.com', 'ummahbuzz.com', 'zoomit.ca', 'chipmark.com', 'affiliated-business.com', 'augmentedviews.com', 'wildbookmarking.com', 'bjbookmarks.com', 'websitebookmarking.net', 'bookmarkca.tk', 'bd24radio.com', 'letsoverrun.com', 'bookmarkingjunction.com', 'bookmarkingmob.com', 'awesomitybookmarks.com', 'foxybookmarks.com', 'fixbookmarks.com', 'diggit.in', 'bingbookmark.com', 'tobookmarking.com', ]

  attr_accessor :url, :content, :title, :embedly_description, :embedly_provider, :embedly_type

  def initialize(url)
    @url = URI.encode(url) # Twitter can return poorly formatted URLs
  end

  def fetch
    # TODO handle or rescue URI::InvalidURIError
    response = HTTParty.get(@url)
    @content = response.body
    @title = (/<title>(.*?)<\/title>/im).match(@content).try(:[],1)
    self
  end

  def fetch_embedly
    response = HTTParty.get("http://api.embed.ly/1/oembed?url=#{CGI.escape(@url)}&key=#{ENV['EMBEDLY_KEY']}")
    @embedly_description = response['description']
    @embedly_provider = response['provider_name']
    @embedly_type = response['type']
    @title = response['title'] unless response['title'].nil?
    @url = response['url'] unless response['url'].nil?
    self
  end

  def search(*terms)
    # TODO handle or rescue Encoding::CompatibilityError
    !!(@content =~ /#{terms.join('|')}/i)
  end

  def blacklisted?
    host  = URI.parse(@url).host # e.g. www.crunchbase.com
    !BLACKLIST.find { |bl_domain| !!(host =~ /#{Regexp.escape(bl_domain)}/) }.nil?
  end

  def ==(page)
    self.url == page.url
  end

end